var e={144:function(e,t){var n,o;n=function(e,t){var n=5e3,o="callback";function r(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function a(e){try{delete window[e]}catch(t){window[e]=void 0}}function l(e){var t=document.getElementById(e);t&&document.getElementsByTagName("head")[0].removeChild(t)}t.exports=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=e,c=t.timeout||n,u=t.jsonpCallback||o,s=void 0;return new Promise((function(n,o){var d=t.jsonpCallbackFunction||r(),p=u+"_"+d;window[d]=function(e){n({ok:!0,json:function(){return Promise.resolve(e)}}),s&&clearTimeout(s),l(p),a(d)},i+=-1===i.indexOf("?")?"?":"&";var m=document.createElement("script");m.setAttribute("src",""+i+u+"="+d),t.charset&&m.setAttribute("charset",t.charset),t.nonce&&m.setAttribute("nonce",t.nonce),t.referrerPolicy&&m.setAttribute("referrerPolicy",t.referrerPolicy),m.id=p,document.getElementsByTagName("head")[0].appendChild(m),s=setTimeout((function(){o(new Error("JSONP request to "+e+" timed out")),a(d),l(p),window[d]=function(){a(d)}}),c),m.onerror=function(){o(new Error("JSONP request to "+e+" failed")),a(d),l(p),s&&clearTimeout(s)}}))}},void 0===(o=n.apply(t,[t,e]))||(e.exports=o)}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o={};(()=>{n.d(o,{Z:()=>i});var e=n(144),t=n.n(e),r="[[>]] {TWEET} {NEWLINE} [üê¶]({URL}) by {AUTHOR_NAME} on [[{DATE}]]";async function a(e,n,o){null!=o&&""!=o||alert("Tweet Extract template not set");var r=new RegExp(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/,"ig");let a=function(e){let t=e.match(r);return null!=t?t[t.length-1]:0}(n);t()("https://publish.twitter.com/oembed?omit_script=1&url="+a).then((function(e){return e.json()})).then((function(t){let n=function(e){e=e.replaceAll("<br>","{NEWLINE}");let t=document.createElement("div");t.innerHTML=e;let n=t.querySelector("p"),o=n.innerText||n.textContent,r=t.querySelectorAll("a");return[o,r[r.length-1].text]}(t.html),r=n[0],l=n[1],i=new Date(Date.parse(l));i=window.roamAlphaAPI.util.dateToPageTitle(i);var c=o.replaceAll("{TWEET}",r);c=(c=(c=(c=(c=(c=c.replaceAll("{URL}",a)).replaceAll("{AUTHOR_NAME}",t.author_name)).replaceAll("{AUTHOR_HANDLE}",t.author_url.split("/").slice(-1))).replaceAll("{AUTHOR_URL}",t.author_url)).replaceAll("{DATE}",i)).replaceAll("{NEWLINE}","\n"),window.roamAlphaAPI.updateBlock({block:{uid:e,string:c}})})).catch((function(e){console.log("parsing failed",e),n="{{‚ö† PARSE ERROR ‚ö†}} "+n}))}let l;const i={onload:async function({extensionAPI:e}){console.log("load tweet extract plugin"),e.settings.get("tweet-template")||await e.settings.set("tweet-template",r);const t={tabTitle:"Tweet Extract",settings:[{id:"tweet-template",name:"Tweet Template",description:"variables available are {TWEET}, {URL}, {AUTHOR_NAME}, {AUTHOR_HANDLE}, {AUTHOR_URL}, {DATE}, {NEWLINE} as well as all Roam syntax",action:{type:"input",onChange:async t=>{r=t.target.value,await e.settings.set("tweet-template",t.target.value)}}}]};e.settings.panel.create(t),l=function(t){if((t=t||event).ctrlKey&&t.shiftKey&&"E"===t.key){let t=window.roamAlphaAPI.ui.getFocusedBlock();null!=t&&(n=t["block-uid"],o=e.settings.get("tweet-template"),a(n,window.roamAlphaAPI.q("[:find ?s .\n                  :in $ ?uid\n                  :where \n                    [?e :block/uid ?uid]\n                    [?e :block/string ?s]\n                ]",n),o))}var n,o},window.addEventListener("keydown",l,!1),roamAlphaAPI.ui.blockContextMenu.addCommand({label:"Extract Tweet",callback:t=>a(t["block-uid"],t["block-string"],e.settings.get("tweet-template"))})},onunload:function(){window.removeEventListener("keydown",l,!1),roamAlphaAPI.ui.blockContextMenu.removeCommand({label:"Extract Tweet"}),console.log("unload tweet extract plugin")}}})();var r=o.Z;export{r as default};